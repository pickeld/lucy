# RAG Evaluation Query Set
#
# Multilingual query set for evaluating retrieval quality.
# Each query has an intent category, language, and expected behavior.
#
# Usage:
#   python tests/eval/evaluate_rag.py
#
# Categories:
#   find_message   — locate a specific message or conversation
#   extract_fact   — extract a factual detail (ID, date, name)
#   summarize      — summarize a thread or topic
#   who_said       — attribution: who said X?
#   when_happened  — temporal: when did X happen?
#   find_document  — find a specific document clause or content
#   multi_turn     — follow-up question (requires condense step)

queries:
  # === Hebrew queries ===
  - id: he_01
    query: "מה התעודת זהות של דוד?"
    language: he
    intent: extract_fact
    notes: "Should find ID number from Paperless documents"
    
  - id: he_02
    query: "בת כמה מיה?"
    language: he
    intent: extract_fact
    notes: "Should use entity store birth_date or find in messages"

  - id: he_03
    query: "מה דורון שאל אותי?"
    language: he
    intent: find_message
    notes: "Disambiguation test — multiple Dorons should trigger clarification"

  - id: he_04
    query: "מתי הפגישה עם עורך הדין?"
    language: he
    intent: when_happened
    notes: "Should find appointment/meeting references"

  - id: he_05
    query: "תסכם לי את השיחה עם שירן מאתמול"
    language: he
    intent: summarize
    notes: "Summarize recent conversation with specific person"

  - id: he_06
    query: "למי שייכת תעודה הזהות 227839586?"
    language: he
    intent: extract_fact
    notes: "Reverse ID lookup — should use numbers keyword index"

  - id: he_07
    query: "מה כתוב בהסכם הגירושין על הילדים?"
    language: he
    intent: find_document
    notes: "Should find Paperless document clause about children"

  - id: he_08
    query: "מי שלח לי הודעה היום?"
    language: he
    intent: find_message
    notes: "Recency-based — should use today's messages"

  - id: he_09
    query: "מה קרה עם הניתוח של שירן?"
    language: he
    intent: find_message
    notes: "Hebrew morphology test — should find messages about surgery"

  - id: he_10
    query: "מה האימייל האחרון שקיבלתי?"
    language: he
    intent: find_message
    notes: "Should use Gmail source filter + recency"

  # === English queries ===
  - id: en_01
    query: "What is David's ID number?"
    language: en
    intent: extract_fact
    notes: "English version of he_01"

  - id: en_02
    query: "When did we last talk about the divorce agreement?"
    language: en
    intent: when_happened
    notes: "Should find Paperless document or messages about divorce"

  - id: en_03
    query: "Show me all messages from Shiran last week"
    language: en
    intent: find_message
    notes: "Metadata filter test — sender + date range"

  - id: en_04
    query: "What did the email from the lawyer say?"
    language: en
    intent: find_message
    notes: "Gmail source + topic filter"

  - id: en_05
    query: "How old is Ben Pikel?"
    language: en
    intent: extract_fact
    notes: "Entity store age computation"

  # === Mixed-script queries ===
  - id: mx_01
    query: "מה Doron Yazkirovich שאל אותי?"
    language: mixed
    intent: find_message
    notes: "Hebrew query with English name — cross-script matching"

  - id: mx_02
    query: "What did דורון tell me about the meeting?"
    language: mixed
    intent: find_message
    notes: "English query with Hebrew name"

  - id: mx_03
    query: "תראה לי מיילים מ-Gmail על הנושא של insurance"
    language: mixed
    intent: find_message
    notes: "Hebrew query with English topic and source reference"

  # === Multi-turn follow-ups ===
  - id: mt_01
    query: "ושל מיה?"
    language: he
    intent: multi_turn
    notes: "Follow-up to he_01 — should resolve 'of Mia' + 'ID number' from history"
    depends_on: he_01

  - id: mt_02
    query: "And his?"
    language: en
    intent: multi_turn
    notes: "Follow-up — should resolve pronoun from history"
    depends_on: en_01

  - id: mt_03
    query: "1"
    language: none
    intent: multi_turn
    notes: "Numbered disambiguation response — should map to first option"
    depends_on: he_03
